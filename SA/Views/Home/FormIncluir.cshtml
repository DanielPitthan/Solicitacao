@model SA.Models.Solicitacao
@{
    ViewBag.Title = "FormIncluir";
}

@section ScriptsHead{
    <script src="~/Content/Scripts/sa.js"></script>
}

@using (Html.BeginForm("Adicionar", "Home", FormMethod.Post))
{
    @Html.Partial("_FormSa")
   
}

@section Scripts{
    <script src="~/Content/Scripts/jquery-3.2.1.js"></script>
    <script src="~/Content/Scripts/jquery.validate.js"></script>
    <script src="~/Content/Scripts/jquery.validate.unobtrusive.js"></script>
    <script src="~/Content/Scripts/bootstrap.min.js"></script>  
    
    
    <script>

      var btAdiciona = document.getElementById("btincluir");

      btincluir.onclick =  function(){
        AdicionaArray();
        AtualizaGrid();
      }
    </script>

    <script>
        var produtodigita = document.getElementById("produto");
        var urldest = "@Url.Action("GetLista", "Produtos")";
       

        produtodigita.onkeypress = function()
        {
            var listaProduto = document.getElementById("lstproduto");
            var listaHtml = "";

            //Verifica se a quantide digitada é maior que 2
            if (produtodigita.value.length > 2) {

                //Faz a consulta no server pela digitação
                $.ajax({
                    url: urldest,
                    type: "GET",
                    data: { 'produtoDesci': produtodigita.value },
                    success: function (response) {

                        for (var i = 0; i < response.lista.length; i++) {
                            var texto = response.lista[i].Codigo + response.lista[i].Descricao;
                            listaHtml += "<option value='" + texto + "'>";
                        }
                        listaProduto.outerHTML = ' <datalist id="lstproduto">' + listaHtml + "</datalist>";

                    },
                    erro: function (response) {
                        console.log("Fudeu!");
                    }
                })
            }
        }
    </script>
     
};